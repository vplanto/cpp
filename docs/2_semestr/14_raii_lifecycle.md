# –õ–µ–∫—Ü—ñ—è 14: –ñ–∏—Ç—Ç—î–≤–∏–π —Ü–∏–∫–ª (RAII), –ê–Ω–∞—Ç–æ–º—ñ—è –º–µ—Ç–æ–¥—ñ–≤ —Ç–∞ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç—É

[‚Üê –õ–µ–∫—Ü—ñ—è 13](13_oop_philosophy.md) | [Index](index.md) | [–î–∞–ª—ñ: –õ–µ–∫—Ü—ñ—è 15 ‚Üí](15_rule_of_three.md)


## –ú–µ—Ç–∞
–ú–∏ –Ω–∞–≤—á–∏–ª–∏—Å—è —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ –æ–±'—î–∫—Ç–∏ (L13). –¢–µ–ø–µ—Ä –º–∏ –Ω–∞–≤—á–∏–º–æ—Å—è:
1.  **–ê–≤—Ç–æ–º–∞—Ç–∏–∑—É–≤–∞—Ç–∏ —ó—Ö —Å–º–µ—Ä—Ç—å** (RAII) ‚Äî –≥–æ–ª–æ–≤–Ω–∞ —Ñ—ñ—à–∫–∞ C++.
2.  **–†–æ–∑—É–º—ñ—Ç–∏ –º–∞–≥—ñ—é –º–µ—Ç–æ–¥—ñ–≤** (—â–æ —Ç–∞–∫–µ `this` –Ω–∞—Å–ø—Ä–∞–≤–¥—ñ).
3.  **–û—Ä–≥–∞–Ω—ñ–∑–æ–≤—É–≤–∞—Ç–∏ –∫–æ–¥** (Header vs Implementation).

## –ï–∫—Å–ø—Ä–µ—Å-–æ–ø–∏—Ç—É–≤–∞–Ω–Ω—è

1.  –Ø–∫—â–æ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó —Å—Ç–∞—î—Ç—å—Å—è `throw` (–≤–∏–∫–ª—é—á–µ–Ω–Ω—è), —á–∏ –≤–∏–∫–æ–Ω–∞—î—Ç—å—Å—è –∫–æ–¥, –Ω–∞–ø–∏—Å–∞–Ω–∏–π *–ø—ñ—Å–ª—è* –Ω—å–æ–≥–æ?
2.  –ê —á–∏ –≤–∏–¥–∞–ª–∏—Ç—å—Å—è –ª–æ–∫–∞–ª—å–Ω–∞ –∑–º—ñ–Ω–Ω–∞ (–æ–±'—î–∫—Ç –Ω–∞ —Å—Ç–µ–∫—É), —è–∫–∞ –±—É–ª–∞ —Å—Ç–≤–æ—Ä–µ–Ω–∞ *–¥–æ* `throw`?
3.  –©–æ –Ω–∞—Å–ø—Ä–∞–≤–¥—ñ –æ–∑–Ω–∞—á–∞—î `const` –ø—ñ—Å–ª—è –Ω–∞–∑–≤–∏ –º–µ—Ç–æ–¥—É: `void get() const`?

<details markdown="1">
<summary>–Ü–Ω–∂–µ–Ω–µ—Ä–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å</summary>

1.  **–ù—ñ.** –ü–æ—Ç—ñ–∫ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —Å—Ç—Ä–∏–±–∞—î –æ–¥—Ä–∞–∑—É –¥–æ –±–ª–æ–∫—É `catch`. –í—Å–µ, —â–æ –Ω–∏–∂—á–µ `throw` ‚Äî –º–µ—Ä—Ç–≤–∏–π –∫–æ–¥.
2.  **–¢–∞–∫!** –¶–µ –Ω–∞–∑–∏–≤–∞—î—Ç—å—Å—è **Stack Unwinding**. C++ –≥–∞—Ä–∞–Ω—Ç—É—î –≤–∏–∫–ª–∏–∫ –¥–µ—Å—Ç—Ä—É–∫—Ç–æ—Ä—ñ–≤ –¥–ª—è –≤—Å—ñ—Ö —Å—Ç–µ–∫–æ–≤–∏—Ö –æ–±'—î–∫—Ç—ñ–≤. –¶–µ –±–∞–∑–∞ RAII.
3.  –¶–µ –æ–±—ñ—Ü—è–Ω–∫–∞ –∫–æ–º–ø—ñ–ª—è—Ç–æ—Ä—É (—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—É): "–¶–µ–π –º–µ—Ç–æ–¥ **–Ω–µ –∑–º—ñ–Ω—é—î** —ñ–Ω–≤–∞—Ä—ñ–∞–Ω—Ç –æ–±'—î–∫—Ç–∞" (read-only –¥–æ—Å—Ç—É–ø).

</details>

---

## –ß–∞—Å—Ç–∏–Ω–∞ 1: RAII ‚Äî –†–µ—Å—É—Ä—Å —è–∫ –û–±'—î–∫—Ç

–ú–∏–Ω—É–ª–æ–≥–æ —Ä–∞–∑—É –º–∏ –≥–æ–≤–æ—Ä–∏–ª–∏ –ø—Ä–æ –î–µ—Å—Ç—Ä—É–∫—Ç–æ—Ä. –¢–µ–ø–µ—Ä —á–∞—Å –∑—Ä–æ–∑—É–º—ñ—Ç–∏ –Ω–∞–π–≤–∞–∂–ª–∏–≤—ñ—à—É —ñ–¥—ñ–æ–º—É C++: **RAII** (Resource Acquisition Is Initialization).

### –ü—Ä–æ–±–ª–µ–º–∞: "–ó–∞–±—É–¥—å–∫—É–≤–∞—Ç–∏–π –ø—Ä–æ–≥—Ä–∞–º—ñ—Å—Ç"
–£ C (—ñ –≤ —Å—Ç–∞—Ä–æ–º—É —Å—Ç–∏–ª—ñ) –º–∏ –∫–µ—Ä—É–≤–∞–ª–∏ —Ä–µ—Å—É—Ä—Å–∞–º–∏ –≤—Ä—É—á–Ω—É:
```cpp
void badCode() {
    FILE* f = fopen("secret.txt", "r"); // (1) –í—ñ–¥–∫—Ä–∏–ª–∏
    // ... 100 —Ä—è–¥–∫—ñ–≤ –∫–æ–¥—É ...
    if (error) return; // –ó–ê–ë–£–õ–ò fclose(f)! –†–µ—Å—É—Ä—Å "–ø–æ—Ç—ñ–∫" –Ω–∞–∑–∞–≤–∂–¥–∏.
    fclose(f); // (2) –ó–∞–∫—Ä–∏–ª–∏ (—è–∫—â–æ –ø–æ—â–∞—Å—Ç–∏—Ç—å –¥—ñ–π—Ç–∏ —Å—é–¥–∏)
}

```

### –†—ñ—à–µ–Ω–Ω—è: RAII (SBRM)

–ú–∏ –ø—Ä–∏–≤'—è–∑—É—î–º–æ –∂–∏—Ç—Ç—è —Ä–µ—Å—É—Ä—Å—É (—Ñ–∞–π–ª—É, –ø–∞–º'—è—Ç—ñ, –∑'—î–¥–Ω–∞–Ω–Ω—è –∑ –ë–î) –¥–æ –∂–∏—Ç—Ç—è –æ–±'—î–∫—Ç–∞ –Ω–∞ —Å—Ç–µ–∫—É.

1. **Constructor:** –ó–∞—Ö–æ–ø–ª—é—î —Ä–µ—Å—É—Ä—Å.
2. **Destructor:** –ó–≤—ñ–ª—å–Ω—è—î —Ä–µ—Å—É—Ä—Å.

```cpp
class FileHandler {
    FILE* f;
public:
    FileHandler(const char* name) { 
        f = fopen(name, "r"); 
        if (!f) throw std::runtime_error("File not found");
    }
    
    // –î–µ—Å—Ç—Ä—É–∫—Ç–æ—Ä –∑–∞–≤–∂–¥–∏ –≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è –ø—Ä–∏ –≤–∏—Ö–æ–¥—ñ –∑ scope
    ~FileHandler() { 
        if (f) {
            fclose(f); 
            std::cout << "File closed automatically.\n";
        }
    }
};

void goodCode() {
    FileHandler fh("secret.txt"); // –í—ñ–¥–∫—Ä–∏–≤—Å—è
    if (true) return; // fh –∑–Ω–∏—â—É—î—Ç—å—Å—è —Ç—É—Ç, —Ñ–∞–π–ª –∑–∞–∫—Ä–∏–≤–∞—î—Ç—å—Å—è –°–ê–ú.
}

```

> **–ü—Ä–∞–≤–∏–ª–æ:** –ù—ñ–∫–æ–ª–∏ –Ω–µ –ø–∏—à—ñ—Ç—å `delete` –∞–±–æ `close()` –≤—Ä—É—á–Ω—É –≤ –±—ñ–∑–Ω–µ—Å-–ª–æ–≥—ñ—Ü—ñ. –ó–∞–≥–æ—Ä–Ω—ñ—Ç—å —Ü–µ –≤ –∫–ª–∞—Å.

### Recursive Destructors ‚Äî Stack Overflow Risk

> **üí° Code Detail from Source Material**  
> [PDF_REF: Using the trees.pdf]

–î–µ—Å—Ç—Ä—É–∫—Ç–æ—Ä–∏ –º–æ–∂—É—Ç—å –≤–∏–∫–ª–∏–∫–∞—Ç–∏ —ñ–Ω—à—ñ –¥–µ—Å—Ç—Ä—É–∫—Ç–æ—Ä–∏. –¶–µ –∑—Ä—É—á–Ω–æ –¥–ª—è —ñ—î—Ä–∞—Ä—Ö—ñ—á–Ω–∏—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä (—è–∫ –¥–µ—Ä–µ–≤–∞), –∞–ª–µ –º–∞—î **–Ω–µ–±–µ–∑–ø–µ–∫—É stack overflow**.

**–ü—Ä–∏–∫–ª–∞–¥: Binary Tree Node**

```cpp
struct Node {
    int data;
    Node* left;
    Node* right;
    
    // –†–µ–∫—É—Ä—Å–∏–≤–Ω–∏–π –¥–µ—Å—Ç—Ä—É–∫—Ç–æ—Ä
    ~Node() {
        delete left;   // –í–∏–∫–ª–∏–∫–∞—î ~Node() –¥–ª—è –ª—ñ–≤–æ–≥–æ –ø—ñ–¥–¥–µ—Ä–µ–≤–∞
        delete right;  // –í–∏–∫–ª–∏–∫–∞—î ~Node() –¥–ª—è –ø—Ä–∞–≤–æ–≥–æ –ø—ñ–¥–¥–µ—Ä–µ–≤–∞
    }
};
```

**–Ø–∫ —Ü–µ –ø—Ä–∞—Ü—é—î:**

```
–î–µ—Ä–µ–≤–æ:
        10
       /  \
      5   15
     / \
    3   7

–ü–æ—Ä—è–¥–æ–∫ –∑–Ω–∏—â–µ–Ω–Ω—è (post-order):
1. ~Node(3)
2. ~Node(7)
3. ~Node(5)   ‚Üê –≤–∏–∫–ª–∏–∫–∞—î delete left; delete right;
4. ~Node(15)
5. ~Node(10)
```

**‚ö†Ô∏è –ü–†–û–ë–õ–ï–ú–ê: Stack Overflow –¥–ª—è –≥–ª–∏–±–æ–∫–∏—Ö –¥–µ—Ä–µ–≤**

–ö–æ–∂–µ–Ω –≤–∏–∫–ª–∏–∫ –¥–µ—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞ –∑–∞–π–º–∞—î –º—ñ—Å—Ü–µ –Ω–∞ —Å—Ç–µ–∫—É (stack frame). –î–ª—è –∑–±–∞–ª–∞–Ω—Å–æ–≤–∞–Ω–æ–≥–æ –¥–µ—Ä–µ–≤–∞ –∑ 1,000,000 –≤—É–∑–ª—ñ–≤ –≥–ª–∏–±–∏–Ω–∞ ~20 ‚Äî —Ü–µ –û–ö. –ê–ª–µ –¥–ª—è **–Ω–µ–∑–±–∞–ª–∞–Ω—Å–æ–≤–∞–Ω–æ–≥–æ** –¥–µ—Ä–µ–≤–∞ (–ª—ñ–Ω—Ü—ñ–π–Ω–∏–π –ª–∞–Ω—Ü—é–∂–æ–∫) –≥–ª–∏–±–∏–Ω–∞ = 1,000,000 ‚Üí **stack overflow!**

```cpp
// –°—Ç–≤–æ—Ä—é—î–º–æ –ª—ñ–Ω—ñ—î–≤–∏–π –ª–∞–Ω—Ü—é–∂–æ–∫ (worst case)
Node* root = new Node{1, nullptr, nullptr};
Node* current = root;

for (int i = 2; i <= 100'000; i++) {
    current->right = new Node{i, nullptr, nullptr};
    current = current->right;
}

delete root;  // ‚ùå Stack overflow! –ì–ª–∏–±–∏–Ω–∞ —Ä–µ–∫—É—Ä—Å—ñ—ó = 100,000
```

**–†—ñ—à–µ–Ω–Ω—è 1: Iterative Destruction (—Ä—É—á–Ω–∏–π —Å—Ç–µ–∫)**

```cpp
~Node() {
    std::stack<Node*> toDelete;
    toDelete.push(this->left);
    toDelete.push(this->right);
    
    this->left = this->right = nullptr;  // –ó–∞–ø–æ–±—ñ–≥—Ç–∏ –ø–æ–¥–≤—ñ–π–Ω–æ–º—É –≤–∏–¥–∞–ª–µ–Ω–Ω—é
    
    while (!toDelete.empty()) {
        Node* node = toDelete.top();
        toDelete.pop();
        
        if (node) {
            toDelete.push(node->left);
            toDelete.push(node->right);
            node->left = node->right = nullptr;
            delete node;
        }
    }
}
```

**–†—ñ—à–µ–Ω–Ω—è 2: –ë–∞–ª–∞–Ω—Å—É–≤–∞–Ω–Ω—è –¥–µ—Ä–µ–≤–∞ (AVL, Red-Black)**

–ì–∞—Ä–∞–Ω—Ç—É—î, —â–æ –≥–ª–∏–±–∏–Ω–∞ –∑–∞–≤–∂–¥–∏ O(log N), —Ç–æ–º—É —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–∏–π –¥–µ—Å—Ç—Ä—É–∫—Ç–æ—Ä –±–µ–∑–ø–µ—á–Ω–∏–π.

**–ö–æ–ª–∏ —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–∏–π –¥–µ—Å—Ç—Ä—É–∫—Ç–æ—Ä –±–µ–∑–ø–µ—á–Ω–∏–π:**
- –ó–±–∞–ª–∞–Ω—Å–æ–≤–∞–Ω—ñ –¥–µ—Ä–µ–≤–∞ (–≥–ª–∏–±–∏–Ω–∞ ‚â§ 20-30)
- –ù–µ–≤–µ–ª–∏–∫—ñ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ (< 1000 –µ–ª–µ–º–µ–Ω—Ç—ñ–≤)
- –ì–∞—Ä–∞–Ω—Ç–æ–≤–∞–Ω–∞ –æ–±–º–µ–∂–µ–Ω–∞ –≥–ª–∏–±–∏–Ω–∞

**–ö–æ–ª–∏ –Ω–µ–±–µ–∑–ø–µ—á–Ω–∏–π:**
- –ù–µ–∑–±–∞–ª–∞–Ω—Å–æ–≤–∞–Ω—ñ –¥–µ—Ä–µ–≤–∞ (linked list disguised as tree)
- User-generated data (–≤–∏ –Ω–µ –∫–æ–Ω—Ç—Ä–æ–ª—é—î—Ç–µ –≥–ª–∏–±–∏–Ω—É)
- –í–µ–ª–∏–∫—ñ –≥—Ä–∞—Ñ–∏ (cycles –ø–æ—Ç—Ä–µ–±—É—é—Ç—å –æ–∫—Ä–µ–º–æ—ó –ª–æ–≥—ñ–∫–∏)

---

## –ß–∞—Å—Ç–∏–Ω–∞ 2: –ê–Ω–∞—Ç–æ–º—ñ—è –º–µ—Ç–æ–¥—É (`this`)

–°—Ç—É–¥–µ–Ω—Ç–∏ —á–∞—Å—Ç–æ –¥—É–º–∞—é—Ç—å, —â–æ –º–µ—Ç–æ–¥–∏ –∂–∏–≤—É—Ç—å *–≤—Å–µ—Ä–µ–¥–∏–Ω—ñ* –æ–±'—î–∫—Ç–∞.
–ù–∞—Å–ø—Ä–∞–≤–¥—ñ, –æ–±'—î–∫—Ç —É –ø–∞–º'—è—Ç—ñ ‚Äî —Ü–µ **—Ç—ñ–ª—å–∫–∏ –¥–∞–Ω—ñ** (`struct` fields). –ú–µ—Ç–æ–¥–∏ –∂–∏–≤—É—Ç—å —É —Å–µ–∫—Ü—ñ—ó –∫–æ–¥—É (Text Segment) —ñ –≤–æ–Ω–∏ **—Å–ø—ñ–ª—å–Ω—ñ** –¥–ª—è –≤—Å—ñ—Ö –æ–±'—î–∫—Ç—ñ–≤ –∫–ª–∞—Å—É.

–Ø–∫ –∂–µ –º–µ—Ç–æ–¥ –∑–Ω–∞—î, –∑ —è–∫–∏–º —Å–∞–º–µ –æ–±'—î–∫—Ç–æ–º –≤—ñ–Ω –ø—Ä–∞—Ü—é—î?
–ß–µ—Ä–µ–∑ –ø—Ä–∏—Ö–æ–≤–∞–Ω–∏–π –∞—Ä–≥—É–º–µ–Ω—Ç **`this`**.

### –©–æ –±–∞—á–∏—Ç–µ –≤–∏:

```cpp
class Point { 
    int x;
public:
    void setX(int val) { 
        x = val; // –Ø–∫ –≤—ñ–Ω –∑–Ω–∞—î, —á–∏–π —Ü–µ x?
    }
};

Point p1, p2;
p1.setX(10);

```

### –©–æ –±–∞—á–∏—Ç—å –∫–æ–º–ø—ñ–ª—è—Ç–æ—Ä (Under the hood):

```cpp
// –ú–µ—Ç–æ–¥ –ø–µ—Ä–µ—Ç–≤–æ—Ä—é—î—Ç—å—Å—è –Ω–∞ –≥–ª–æ–±–∞–ª—å–Ω—É —Ñ—É–Ω–∫—Ü—ñ—é
void Point_setX(Point* const this, int val) {
    this->x = val;
}

// –í–∏–∫–ª–∏–∫ –ø–µ—Ä–µ—Ç–≤–æ—Ä—é—î—Ç—å—Å—è –Ω–∞:
Point_setX(&p1, 10);

```

**`this`** ‚Äî —Ü–µ –≤–∫–∞–∑—ñ–≤–Ω–∏–∫ –Ω–∞ –ø–æ—Ç–æ—á–Ω–∏–π –æ–±'—î–∫—Ç, –¥–ª—è —è–∫–æ–≥–æ –≤–∏–∫–ª–∏–∫–∞–Ω–æ –º–µ—Ç–æ–¥.
–í—ñ–Ω –ø–æ—Ç—Ä—ñ–±–µ–Ω, –∫–æ–ª–∏:

1. –Ü–º'—è –∞—Ä–≥—É–º–µ–Ω—Ç—É –∑–±—ñ–≥–∞—î—Ç—å—Å—è –∑ –ø–æ–ª–µ–º (`this->x = x`).
2. –¢—Ä–µ–±–∞ –ø–æ–≤–µ—Ä–Ω—É—Ç–∏ –ø–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ —Å–∞–º–æ–≥–æ —Å–µ–±–µ (`return *this` ‚Äî –ø–æ–±–∞—á–∏–º–æ –≤ Operator Overloading).

---

## –ß–∞—Å—Ç–∏–Ω–∞ 3: Const Correctness (–ó–∞—Ö–∏—Å—Ç –Ü–Ω–≤–∞—Ä—ñ–∞–Ω—Ç–∞)

–Ø–∫—â–æ –º–∏ –ø–µ—Ä–µ–¥–∞—î–º–æ –æ–±'—î–∫—Ç —É —Ñ—É–Ω–∫—Ü—ñ—é —è–∫ `const Date& d`, –º–∏ –æ–±—ñ—Ü—è—î–º–æ –Ω–µ –∑–º—ñ–Ω—é–≤–∞—Ç–∏ –π–æ–≥–æ. –ê–ª–µ —è–∫ –∫–æ–º–ø—ñ–ª—è—Ç–æ—Ä –¥—ñ–∑–Ω–∞—î—Ç—å—Å—è, —è–∫—ñ –º–µ—Ç–æ–¥–∏ –∑–º—ñ–Ω—é—é—Ç—å –æ–±'—î–∫—Ç, –∞ —è–∫—ñ ‚Äî –Ω—ñ?

–ú–∏ –º–∞—î–º–æ —è–≤–Ω–æ –ø–æ–º—ñ—Ç–∏—Ç–∏ –º–µ—Ç–æ–¥–∏ —è–∫ "–±–µ–∑–ø–µ—á–Ω—ñ" (`const`).

```cpp
class Date {
    int day;
public:
    int getDay() const { // Read-only –º–µ—Ç–æ–¥
        // day = 5; // error: assignment of member 'Date::day' in read-only object
        return day;
    }

    void setDay(int d) { // Mutating –º–µ—Ç–æ–¥ (–±–µ–∑ const)
        day = d;
    }
};

void printDate(const Date& d) {
    cout << d.getDay(); // –û–ö: –≤–∏–∫–ª–∏–∫–∞—î–º–æ const –º–µ—Ç–æ–¥
    // d.setDay(10);    // error: passing 'const Date' as 'this' argument discards qualifiers
}

```

> **üí° Code Detail from Source Material**  
> [PDF: s02e01. OOP by examples.pdf, Page 369]
>
> **Exact Compiler Error Messages:**
> - –°–ø—Ä–æ–±–∞ –∑–º—ñ–Ω–∏—Ç–∏ —á–ª–µ–Ω –≤ const –º–µ—Ç–æ–¥—ñ: `error: assignment of member 'ClassName::memberName' in read-only object`
> - –°–ø—Ä–æ–±–∞ –≤–∏–∫–ª–∏–∫–∞—Ç–∏ non-const –º–µ—Ç–æ–¥ –Ω–∞ const –æ–±'—î–∫—Ç—ñ: `error: passing 'const ClassName' as 'this' argument discards qualifiers`
>
> –¶—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –∑'—è–≤–ª—è—Ç—å—Å—è –ø—Ä–∏ –∫–æ–º–ø—ñ–ª—è—Ü—ñ—ó —ñ –¥–æ–ø–æ–º–æ–∂—É—Ç—å –∑—Ä–æ–∑—É–º—ñ—Ç–∏, —â–æ —Å–∞–º–µ –ø–æ—Ä—É—à–µ–Ω–æ. –ó–∞–ø–∞–º'—è—Ç–∞–π—Ç–µ —ó—Ö –¥–ª—è –¥–µ–±–∞–≥—É –≤–ª–∞—Å–Ω–æ–≥–æ –∫–æ–¥—É!

**Best Practice:** –Ø–∫—â–æ –º–µ—Ç–æ–¥ –Ω–µ –∑–º—ñ–Ω—é—î –ø–æ–ª—è –∫–ª–∞—Å—É ‚Äî **–∑–æ–±–æ–≤'—è–∑–∞–Ω–∏–π** –±—É—Ç–∏ `const`.

---

## –ß–∞—Å—Ç–∏–Ω–∞ 4: –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç—É (.h vs .cpp)

–î–æ—Å—ñ –º–∏ –ø–∏—Å–∞–ª–∏ –≤—Å–µ –≤ –æ–¥–Ω–æ–º—É —Ñ–∞–π–ª—ñ. –£ —Ä–µ–∞–ª—å–Ω–∏—Ö –ø—Ä–æ–µ–∫—Ç–∞—Ö –º–∏ —Ä–æ–∑–¥—ñ–ª—è—î–º–æ **–Ü–Ω—Ç–µ—Ä—Ñ–µ–π—Å** (Declaration) —Ç–∞ **–†–µ–∞–ª—ñ–∑–∞—Ü—ñ—é** (Definition).

### –ß–æ–º—É? (Separation of Concerns)

1. **–®–≤–∏–¥–∫—ñ—Å—Ç—å –∑–±—ñ—Ä–∫–∏:** –Ø–∫—â–æ –≤–∏ –∑–º—ñ–Ω–∏–ª–∏ –ª–æ–≥—ñ–∫—É –≤ `.cpp`, –ø–µ—Ä–µ–∫–æ–º–ø—ñ–ª—é—î—Ç—å—Å—è –ª–∏—à–µ –æ–¥–∏–Ω —Ñ–∞–π–ª.
2. **API Design:** –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤–∞—à–æ–≥–æ –∫–ª–∞—Å—É —á–∏—Ç–∞—î `.h` —Ñ–∞–π–ª —è–∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—é. –ô–æ–º—É –Ω–µ —Ç—Ä–µ–±–∞ –±–∞—á–∏—Ç–∏ "–∫–∏—à–∫–∏" (—Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—é).

–°—Ö–µ–º–∞ —Ñ–∞–π–ª—ñ–≤:

**1. `BankAccount.h` (–©–û —Ä–æ–±–∏—Ç—å –∫–ª–∞—Å)**
–ú—ñ—Å—Ç–∏—Ç—å: `class`, –ø–æ–ª—è, –ø–ó–∞—Ä–∞–∑ –º–∏ –≤–∏–Ω–æ—Å–∏–º–æ —Ü–µ —É –æ–∫—Ä–µ–º—ñ —Ñ–∞–π–ª–∏ –¥–ª—è –ø–µ—Ä–µ–≤–∞–≥–∏.

### Header Guards ‚Äî Both Syntaxes

> **üí° Code Detail from Source Material**  
> [PDF: s02e02. OOP its getting darker.pdf, Page 391]

–û–±–æ–≤'—è–∑–∫–æ–≤–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ **Include Guards**, —â–æ–± —É–Ω–∏–∫–Ω—É—Ç–∏ –¥—É–±–ª—é–≤–∞–Ω–Ω—è –∫–æ–¥—É –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º—É `#include`. –Ü—Å–Ω—É—î **–¥–≤–∞ —Å–ø–æ—Å–æ–±–∏**:

**Method 1: Standard C++ (#ifndef guards)**

```cpp
// logger.h
#ifndef LOGGER_H
#define LOGGER_H

class Logger {
public:
    void log(const std::string& msg);
};

#endif  // LOGGER_H
```

**Method 2: Modern (#pragma once)**

```cpp
// logger.h
#pragma once

class Logger {
public:
    void log(const std::string& msg);
};
```

**–ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è:**

| –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞ | #ifndef Guards | #pragma once |
|----------------|----------------|--------------|
| **–°—Ç–∞–Ω–¥–∞—Ä—Ç C++** | ‚úì –û—Ñ—ñ—Ü—ñ–π–Ω–∞ —á–∞—Å—Ç–∏–Ω–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç—É | ‚ùå Compiler extension (non-standard) |
| **–ü—ñ–¥—Ç—Ä–∏–º–∫–∞** | 100% –∫–æ–º–ø—ñ–ª—è—Ç–æ—Ä—ñ–≤ | ~99.9% (GCC, Clang, MSVC, ICC) |
| **–†–∏–∑–∏–∫ –∫–æ–Ω—Ñ–ª—ñ–∫—Ç—ñ–≤** | –ú–æ–∂–ª–∏–≤–∏–π (—è–∫—â–æ –¥–≤–∞ —Ñ–∞–π–ª–∏ –º–∞—é—Ç—å –æ–¥–Ω–∞–∫–æ–≤—ñ —ñ–º–µ–Ω–∞ –º–∞–∫—Ä–æ—Å—ñ–≤) | –ù–µ–º–∞—î (based on file identity) |
| **–ß–∏—Ç–∞–±–µ–ª—å–Ω—ñ—Å—Ç—å** | –ë—ñ–ª—å—à–µ —Ç–µ–∫—Å—Ç—É (3 —Ä—è–¥–∫–∏) | –ö–æ–º–ø–∞–∫—Ç–Ω—ñ—à–µ (1 —Ä—è–¥–æ–∫) |
| **Performance** | –¢—Ä–æ—Ö–∏ –ø–æ–≤—ñ–ª—å–Ω—ñ—à–µ (–ø–∞—Ä—Å–∏–Ω–≥ –º–∞–∫—Ä–æ—Å—ñ–≤) | –®–≤–∏–¥—à–µ (compiler –º–æ–∂–µ –∫–µ—à—É–≤–∞—Ç–∏) |

**–ö–æ–ª–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –∫–æ–∂–µ–Ω:**

- **#pragma once**: –î–ª—è —Å—É—á–∞—Å–Ω–∏—Ö –ø—Ä–æ–µ–∫—Ç—ñ–≤ (2015+), –¥–µ –≤–∏ –∫–æ–Ω—Ç—Ä–æ–ª—é—î—Ç–µ –∫–æ–º–ø—ñ–ª—è—Ç–æ—Ä
- **#ifndef**: –î–ª—è legacy/portable code, —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞ –æ—Å–≤—ñ—Ç–∞, –∞–±–æ —è–∫—â–æ –≤–∏ –ø–∏—à–µ—Ç–µ –±—ñ–±–ª—ñ–æ—Ç–µ–∫—É –¥–ª—è —à–∏—Ä–æ–∫–æ–≥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

**–¢–∏–ø–æ–≤–∞ –ø–æ–º–∏–ª–∫–∞ (–±–µ–∑ guards):**

```cpp
// point.h (–ë–ï–ó guards)
class Point { int x, y; };

// main.cpp
#include "point.h"
#include "geometry.h"  // –¶—è –≥–µ–æ–º–µ—Ç—Ä—ñ—è —Ç–∞–∫–æ–∂ —Ä–æ–±–∏—Ç—å #include "point.h"

// error: redefinition of 'class Point'
```

**–ó guards:**
```cpp
#pragma once  // –∞–±–æ #ifndef POINT_H

class Point { int x, y; };
```

–¢–µ–ø–µ—Ä –∫–æ–º–ø—ñ–ª—è—Ç–æ—Ä –≤–∫–ª—é—á–∏—Ç—å `point.h` —Ç—ñ–ª—å–∫–∏ –æ–¥–∏–Ω —Ä–∞–∑, –Ω–∞–≤—ñ—Ç—å —è–∫—â–æ –≤—ñ–Ω `#include` –π–æ–≥–æ –±–∞–≥–∞—Ç–æ —Ä–∞–∑—ñ–≤.

---

## –ü—Ä–∞–∫—Ç–∏—á–Ω–µ –∑–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—èstart);
    void deposit(double amount);
};

```

**2. `BankAccount.cpp` (–Ø–ö –≤—ñ–Ω —Ü–µ —Ä–æ–±–∏—Ç—å)**
–ú—ñ—Å—Ç–∏—Ç—å: –∫–æ–¥ –º–µ—Ç–æ–¥—ñ–≤. –û–±–æ–≤'—è–∑–∫–æ–≤–æ –ø—ñ–¥–∫–ª—é—á–∞—î–º–æ —Å–≤—ñ–π —Ö–µ–¥–µ—Ä.

```cpp
#include "BankAccount.h" // 

// –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ Scope Resolution Operator (::) 
BankAccount::BankAccount(double start) {
    balance = start;
}

void BankAccount::deposit(double amount) {
    balance += amount;
}

```

**3. `main.cpp` (–•—Ç–æ —Ü–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î)**

```cpp
#include "BankAccount.h"

int main() {
    BankAccount b(100);
    b.deposit(50);
}

```

---

## –ß–∞—Å—Ç–∏–Ω–∞ 5: Coupling & Cohesion (–ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–Ω–∞ —Ö–≤–∏–ª–∏–Ω–∫–∞)

–¶–µ –≤–∞–∂–ª–∏–≤—ñ –º–µ—Ç—Ä–∏–∫–∏ —è–∫–æ—Å—Ç—ñ –∫–æ–¥—É.

* **Cohesion (–ó—á–µ–ø–ª–µ–Ω–Ω—è –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ):** –ù–∞—Å–∫—ñ–ª—å–∫–∏ –º–µ—Ç–æ–¥–∏ –∫–ª–∞—Å—É —Å—Ç–æ—Å—É—é—Ç—å—Å—è –æ–¥–Ω—ñ—î—ó —Ç–µ–º–∏.
* *Good:* –ö–ª–∞—Å `BankAccount` —Ä–æ–±–∏—Ç—å —Ç—ñ–ª—å–∫–∏ —Ñ—ñ–Ω–∞–Ω—Å–æ–≤—ñ –æ–ø–µ—Ä–∞—Ü—ñ—ó.
* *Bad:* –ö–ª–∞—Å `BankAccount` —Ç–∞–∫–æ–∂ –≤–º—ñ—î –Ω–∞–¥—Å–∏–ª–∞—Ç–∏ Email —ñ –¥—Ä—É–∫—É–≤–∞—Ç–∏ PDF (God Object).

* **Coupling (–ó–∞–ª–µ–∂–Ω—ñ—Å—Ç—å –º—ñ–∂ –∫–ª–∞—Å–∞–º–∏):** –ù–∞—Å–∫—ñ–ª—å–∫–∏ —Å–∏–ª—å–Ω–æ –∫–ª–∞—Å–∏ "–∑–Ω–∞—é—Ç—å" –æ–¥–∏–Ω –ø—Ä–æ –æ–¥–Ω–æ–≥–æ.
* *Meta:* –ú–∏ –ø—Ä–∞–≥–Ω–µ–º–æ –¥–æ **High Cohesion** —Ç–∞ **Low Coupling**. –†–æ–∑–¥—ñ–ª–µ–Ω–Ω—è –Ω–∞ `.h` —Ç–∞ `.cpp` –¥–æ–ø–æ–º–∞–≥–∞—î –∑–º–µ–Ω—à–∏—Ç–∏ Coupling.

---

---

## –ü—Ä–∞–∫—Ç–∏—á–Ω–µ –∑–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è

**–î–∏–≤.:** [–ü—Ä–∞–∫—Ç–∏–∫—É–º 10: RAII Logger](p10_raii_logger.md) ‚Äî –∑–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è RAII –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —Ñ–∞–π–ª–∞–º–∏.

## –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ñ –ø–∏—Ç–∞–Ω–Ω—è

1. –í —á–æ–º—É —Ä—ñ–∑–Ω–∏—Ü—è –º—ñ–∂ `delete` —Ç–∞ –î–µ—Å—Ç—Ä—É–∫—Ç–æ—Ä–æ–º?
2. –í–∏ –Ω–∞–ø–∏—Å–∞–ª–∏ –º–µ—Ç–æ–¥ `int getAge() { return age; }`. –ß–æ–º—É –Ω–∞ Code Review –≤–∞–º –∑—Ä–æ–±–ª—è—Ç—å –∑–∞—É–≤–∞–∂–µ–Ω–Ω—è? (–ü—ñ–¥–∫–∞–∑–∫–∞: `const`).
3. –ù–∞–≤—ñ—â–æ –º–∏ –ø–∏—à–µ–º–æ `MyClass::` –ø–µ—Ä–µ–¥ –Ω–∞–∑–≤–æ—é –º–µ—Ç–æ–¥—É –≤ `.cpp` —Ñ–∞–π–ª—ñ?
4. –©–æ —Ç–∞–∫–µ `#pragma once` —ñ –Ω–∞–≤—ñ—â–æ –≤–æ–Ω–æ —Ç—Ä–µ–±–∞? 

<details markdown="1">
<summary>–í—ñ–¥–ø–æ–≤—ñ–¥—ñ</summary>

1. `delete` ‚Äî —Ü–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä, —è–∫–∏–π –∑–≤—ñ–ª—å–Ω—è—î –ø–∞–º'—è—Ç—å. –î–µ—Å—Ç—Ä—É–∫—Ç–æ—Ä ‚Äî —Ü–µ –º–µ—Ç–æ–¥, —è–∫–∏–π –≥–æ—Ç—É—î –æ–±'—î–∫—Ç –¥–æ –≤–∏–¥–∞–ª–µ–Ω–Ω—è (–∑–∞–∫—Ä–∏–≤–∞—î —Ñ–∞–π–ª–∏ —Ç–æ—â–æ). `delete` –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤–∏–∫–ª–∏–∫–∞—î –î–µ—Å—Ç—Ä—É–∫—Ç–æ—Ä.
2. –ú–µ—Ç–æ–¥, —â–æ —Ç—ñ–ª—å–∫–∏ —á–∏—Ç–∞—î –¥–∞–Ω—ñ, –º–∞—î –±—É—Ç–∏ –ø–æ–∑–Ω–∞—á–µ–Ω–∏–π —è–∫ `const`: `int getAge() const`.
3. –©–æ–± —Å–∫–∞–∑–∞—Ç–∏ –∫–æ–º–ø—ñ–ª—è—Ç–æ—Ä—É, —â–æ —Ü—è —Ñ—É–Ω–∫—Ü—ñ—è –Ω–∞–ª–µ–∂–∏—Ç—å —Å–∞–º–µ –∫–ª–∞—Å—É `MyClass`, –∞ –Ω–µ —î –≥–ª–æ–±–∞–ª—å–Ω–æ—é. –¶–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è –æ–±–ª–∞—Å—Ç—ñ –≤–∏–¥–∏–º–æ—Å—Ç—ñ (Scope Resolution).
4. –¶–µ –∑–∞—Ö–∏—Å—Ç –≤—ñ–¥ –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –≤–∫–ª—é—á–µ–Ω–Ω—è (Include Guard). –Ø–∫—â–æ —Ñ–∞–π–ª `.h` –ø—ñ–¥–∫–ª—é—á–µ–Ω–æ –¥–≤—ñ—á—ñ, —Ü–µ –∑–∞–ø–æ–±—ñ–≥–∞—î –ø–æ–º–∏–ª—Ü—ñ –¥—É–±–ª—é–≤–∞–Ω–Ω—è –æ–≥–æ–ª–æ—à–µ–Ω—å.

</details>

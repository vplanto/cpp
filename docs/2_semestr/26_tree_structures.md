# –õ–µ–∫—Ü—ñ—è 26: Tree Data Structures ‚Äî BST —Ç–∞ Red-Black Trees

[‚Üê –õ–µ–∫—Ü—ñ—è 25](25_string_algorithms.md) | [Index](index.md)

## –ú–µ—Ç–∞

–ó—Ä–æ–∑—É–º—ñ—Ç–∏, —è–∫ –ø—Ä–∞—Ü—é—é—Ç—å –¥–µ—Ä–µ–≤–∞ –ø–æ—à—É–∫—É "–ø—ñ–¥ –∫–∞–ø–æ—Ç–æ–º". –ù–∞–≤—á–∏—Ç–∏—Å—è –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ –æ–ø–µ—Ä–∞—Ü—ñ—ó –∑ BST (–≤—Å—Ç–∞–≤–∫–∞, –≤–∏–¥–∞–ª–µ–Ω–Ω—è, –ø–æ—à—É–∫). –†–æ–∑—ñ–±—Ä–∞—Ç–∏ –º–µ—Ö–∞–Ω—ñ–∑–º –±–∞–ª–∞–Ω—Å—É–≤–∞–Ω–Ω—è Red-Black –¥–µ—Ä–µ–≤ —Ç–∞ –∑—Ä–æ–∑—É–º—ñ—Ç–∏, —á–æ–º—É `std::map` –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —Å–∞–º–µ —ó—Ö.

## –ï–∫—Å–ø—Ä–µ—Å-–æ–ø–∏—Ç—É–≤–∞–Ω–Ω—è

1. –Ø–∫–∞ —Å–∫–ª–∞–¥–Ω—ñ—Å—Ç—å –ø–æ—à—É–∫—É –µ–ª–µ–º–µ–Ω—Ç–∞ —É Binary Search Tree —É –Ω–∞–π–≥—ñ—Ä—à–æ–º—É –≤–∏–ø–∞–¥–∫—É?
2. –ß–∏ –º–æ–∂–µ –Ω–µ–∑–±–∞–ª–∞–Ω—Å–æ–≤–∞–Ω–µ BST –¥–µ–≥—Ä–∞–¥—É–≤–∞—Ç–∏ –¥–æ –ª—ñ–Ω—ñ–π–Ω–æ–≥–æ —Å–ø–∏—Å–∫—É?
3. –©–æ —Ç–∞–∫–µ "rotation" —É –¥–µ—Ä–µ–≤–∞—Ö —ñ –Ω–∞–≤—ñ—â–æ —Ü–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ?

<details markdown="1">
<summary>–Ü–Ω–∂–µ–Ω–µ—Ä–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å</summary>

1. **O(h)**, –¥–µ h ‚Äî –≤–∏—Å–æ—Ç–∞ –¥–µ—Ä–µ–≤–∞. –î–ª—è –∑–±–∞–ª–∞–Ω—Å–æ–≤–∞–Ω–æ–≥–æ –¥–µ—Ä–µ–≤–∞ h = O(log n), –∞–ª–µ –¥–ª—è –Ω–µ–∑–±–∞–ª–∞–Ω—Å–æ–≤–∞–Ω–æ–≥–æ –º–æ–∂–µ –±—É—Ç–∏ h = O(n).
2. **–¢–∞–∫!** –Ø–∫—â–æ –≤—Å—Ç–∞–≤–ª—è—Ç–∏ –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å 1,2,3,4,5 —É –Ω–µ–∑–±–∞–ª–∞–Ω—Å–æ–≤–∞–Ω–µ BST, –æ—Ç—Ä–∏–º–∞—î–º–æ –ª—ñ–Ω—ñ–π–Ω–∏–π –ª–∞–Ω—Ü—é–∂–æ–∫ (–∫–æ–∂–µ–Ω –≤—É–∑–æ–ª –º–∞—î —Ç—ñ–ª—å–∫–∏ –ø—Ä–∞–≤—É –¥–∏—Ç–∏–Ω—É).
3. **Rotation** ‚Äî —Ü–µ –æ–ø–µ—Ä–∞—Ü—ñ—è, —è–∫–∞ –∑–º—ñ–Ω—é—î —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–µ—Ä–µ–≤–∞, –∑–±–µ—Ä—ñ–≥–∞—é—á–∏ BST –≤–ª–∞—Å—Ç–∏–≤—ñ—Å—Ç—å, –∞–ª–µ –∑–º—ñ–Ω—é—é—á–∏ –≤–∏—Å–æ—Ç—É. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –±–∞–ª–∞–Ω—Å—É–≤–∞–Ω–Ω—è.

</details>

---

## –ß–∞—Å—Ç–∏–Ω–∞ 1: Binary Search Tree (BST) ‚Äî –û—Å–Ω–æ–≤–∏

### –í–ª–∞—Å—Ç–∏–≤—ñ—Å—Ç—å BST

–î–ª—è –∫–æ–∂–Ω–æ–≥–æ –≤—É–∑–ª–∞ `node`:
- **–í—Å—ñ –≤—É–∑–ª–∏ —É –ª—ñ–≤–æ–º—É –ø—ñ–¥–¥–µ—Ä–µ–≤—ñ** < `node->key`
- **–í—Å—ñ –≤—É–∑–ª–∏ —É –ø—Ä–∞–≤–æ–º—É –ø—ñ–¥–¥–µ—Ä–µ–≤—ñ** > `node->key`

### –ü—Ä–∏–∫–ª–∞–¥

```
        8
       / \
      3   10
     / \    \
    1   6    14
       / \   /
      4   7 13
```

**–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞:** –î–ª—è –≤—É–∑–ª–∞ `8`: –ª—ñ–≤–µ –ø—ñ–¥–¥–µ—Ä–µ–≤–æ {1,3,4,6,7} < 8, –ø—Ä–∞–≤–µ {10,13,14} > 8. ‚úì

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –≤—É–∑–ª–∞

```cpp
struct Node {
    int key;
    Node* left;
    Node* right;
    Node* parent;  // –î–ª—è –∑—Ä—É—á–Ω–æ—Å—Ç—ñ –Ω–∞–≤—ñ–≥–∞—Ü—ñ—ó
    
    Node(int k) : key(k), left(nullptr), right(nullptr), parent(nullptr) {}
};
```

### –ü–æ—à—É–∫ (Search)

```cpp
Node* search(Node* root, int key) {
    if (root == nullptr || root->key == key) {
        return root;
    }
    
    if (key < root->key) {
        return search(root->left, key);
    } else {
        return search(root->right, key);
    }
}
```

**–°–∫–ª–∞–¥–Ω—ñ—Å—Ç—å:** O(h), –¥–µ h ‚Äî –≤–∏—Å–æ—Ç–∞ –¥–µ—Ä–µ–≤–∞.

### –í—Å—Ç–∞–≤–∫–∞ (Insert)

```cpp
Node* insert(Node* root, int key) {
    if (root == nullptr) {
        return new Node(key);
    }
    
    if (key < root->key) {
        root->left = insert(root->left, key);
        root->left->parent = root;
    } else if (key > root->key) {
        root->right = insert(root->right, key);
        root->right->parent = root;
    }
    // –Ø–∫—â–æ key == root->key, –Ω–µ –≤—Å—Ç–∞–≤–ª—è—î–º–æ –¥—É–±–ª—ñ–∫–∞—Ç
    
    return root;
}
```

### –ú—ñ–Ω—ñ–º—É–º —Ç–∞ –ú–∞–∫—Å–∏–º—É–º

```cpp
Node* find_min(Node* root) {
    while (root && root->left != nullptr) {
        root = root->left;
    }
    return root;
}

Node* find_max(Node* root) {
    while (root && root->right != nullptr) {
        root = root->right;
    }
    return root;
}
```

### –í–∏–¥–∞–ª–µ–Ω–Ω—è (Delete) ‚Äî –Ω–∞–π—Å–∫–ª–∞–¥–Ω—ñ—à–∞ –æ–ø–µ—Ä–∞—Ü—ñ—è

**–¢—Ä–∏ –≤–∏–ø–∞–¥–∫–∏:**

1. **–í—É–∑–æ–ª –±–µ–∑ –¥—ñ—Ç–µ–π** (–ª–∏—Å—Ç) ‚Äî –ø—Ä–æ—Å—Ç–æ –≤–∏–¥–∞–ª—è—î–º–æ
2. **–í—É–∑–æ–ª –∑ –æ–¥–Ω–æ—é –¥–∏—Ç–∏–Ω–æ—é** ‚Äî –∑–∞–º—ñ–Ω—é—î–º–æ –≤—É–∑–æ–ª –π–æ–≥–æ –¥–∏—Ç–∏–Ω–æ—é
3. **–í—É–∑–æ–ª –∑ –¥–≤–æ–º–∞ –¥—ñ—Ç—å–º–∏** ‚Äî –∑–Ω–∞—Ö–æ–¥–∏–º–æ –Ω–∞—Å—Ç—É–ø–Ω–∏–∫–∞ (successor), –∑–∞–º—ñ–Ω—é—î–º–æ –∑–Ω–∞—á–µ–Ω–Ω—è, –≤–∏–¥–∞–ª—è—î–º–æ –Ω–∞—Å—Ç—É–ø–Ω–∏–∫–∞

```cpp
Node* delete_node(Node* root, int key) {
    if (root == nullptr) return root;
    
    if (key < root->key) {
        root->left = delete_node(root->left, key);
    } else if (key > root->key) {
        root->right = delete_node(root->right, key);
    } else {
        // –ó–Ω–∞–π—à–ª–∏ –≤—É–∑–æ–ª –¥–ª—è –≤–∏–¥–∞–ª–µ–Ω–Ω—è
        
        // –í–∏–ø–∞–¥–æ–∫ 1: –õ–∏—Å—Ç –∞–±–æ –æ–¥–∏–Ω –Ω–∞—â–∞–¥–æ–∫
        if (root->left == nullptr) {
            Node* temp = root->right;
            delete root;
            return temp;
        } else if (root->right == nullptr) {
            Node* temp = root->left;
            delete root;
            return temp;
        }
        
        // –í–∏–ø–∞–¥–æ–∫ 2: –î–≤–∞ –Ω–∞—â–∞–¥–∫–∏
        // –ó–Ω–∞—Ö–æ–¥–∏–º–æ –Ω–∞—Å—Ç—É–ø–Ω–∏–∫–∞ (–º—ñ–Ω—ñ–º—É–º —É –ø—Ä–∞–≤–æ–º—É –ø—ñ–¥–¥–µ—Ä–µ–≤—ñ)
        Node* successor = find_min(root->right);
        
        // –ö–æ–ø—ñ—é—î–º–æ –∑–Ω–∞—á–µ–Ω–Ω—è –Ω–∞—Å—Ç—É–ø–Ω–∏–∫–∞
        root->key = successor->key;
        
        // –í–∏–¥–∞–ª—è—î–º–æ –Ω–∞—Å—Ç—É–ø–Ω–∏–∫–∞
        root->right = delete_node(root->right, successor->key);
    }
    
    return root;
}
```

### Binary Tree to Array Mapping

> **üí° Visual Schema from Source Material**  
> [PDF_REF: Trees.pdf]

–ë—ñ–Ω–∞—Ä–Ω–µ –¥–µ—Ä–µ–≤–æ –º–æ–∂–Ω–∞ –∑–±–µ—Ä—ñ–≥–∞—Ç–∏ —É **–ª—ñ–Ω—ñ–π–Ω–æ–º—É –º–∞—Å–∏–≤—ñ** –±–µ–∑ –≤–∫–∞–∑—ñ–≤–Ω–∏–∫—ñ–≤, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –º–∞—Ç–µ–º–∞—Ç–∏—á–Ω—ñ —Ñ–æ—Ä–º—É–ª–∏ –¥–ª—è –Ω–∞–≤—ñ–≥–∞—Ü—ñ—ó.

**–ü—Ä–∏–∫–ª–∞–¥: Complete Binary Tree**

```
Tree Representation:
        A (0)
       /     \
     B (1)   C (2)
    /  \     /
  D(3) E(4) F(5)

Array Representation:
Index:  [0] [1] [2] [3] [4] [5]
Value:  [A] [B] [C] [D] [E] [F]
```

**Navigation Formulas:**

–î–ª—è –≤—É–∑–ª–∞ –Ω–∞ —ñ–Ω–¥–µ–∫—Å—ñ `i`:
- **Left child** = `2*i + 1`
- **Right child** = `2*i + 2`
- **Parent** = `(i - 1) / 2` (integer division)

**–ü—Ä–∏–∫–ª–∞–¥:**
- –ë–∞—Ç—å–∫–æ E (—ñ–Ω–¥–µ–∫—Å 4): `(4-1)/2 = 1` ‚Üí B ‚úì
- –õ—ñ–≤–∞ –¥–∏—Ç–∏–Ω–∞ B (—ñ–Ω–¥–µ–∫—Å 1): `2*1+1 = 3` ‚Üí D ‚úì
- –ü—Ä–∞–≤–∞ –¥–∏—Ç–∏–Ω–∞ A (—ñ–Ω–¥–µ–∫—Å 0): `2*0+2 = 2` ‚Üí C ‚úì

**–í—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è "–ø—Ä–æ–ø—É—Å–∫—ñ–≤" –¥–ª—è non-complete trees:**

```
Non-complete tree:
        A
       / \
      B   C
         /
        D

–ü—Ä–æ–±–ª–µ–º–∞: C –º–∞—î —Ç—ñ–ª—å–∫–∏ –ª—ñ–≤—É –¥–∏—Ç–∏–Ω—É (D), –∞–ª–µ –ø—Ä–∞–≤–∞ –Ω–µ–º–∞—î.

Array (–∑ –ø—Ä–æ–ø—É—Å–∫–∞–º–∏):
Index:  [0] [1] [2] [3] [4] [5] [6]
Value:  [A] [B] [C] [X] [X] [D] [X]
                     ‚Üë       ‚Üë   ‚Üë
              Right of B  Left of C  Right of C

Gap calculation:
- D is left child of C (index 2): 2*2+1 = 5 ‚úì
- Unused slots: [3], [4], [6]
```

**Memory Efficiency Comparison:**

| Tree Property | Waste (Empty Slots) |
|---------------|---------------------|
| **Complete Binary Tree** | 0% (all slots used) |
| **Balanced BST** | ~50% (some gaps) |
| **Skewed Tree** (linear) | ~75% (many gaps!) |

**–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è:**
- **Heap** (complete binary tree) ‚Äî —ñ–¥–µ–∞–ª—å–Ω–æ –¥–ª—è –º–∞—Å–∏–≤—É!
- **Segment Tree** ‚Äî –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è –≤ –º–∞—Å–∏–≤—ñ —Ä–æ–∑–º—ñ—Ä—É 4*N
- **Fenwick Tree** (BIT) ‚Äî 1-indexed array

**–ö–æ–¥ –ø—Ä–∏–∫–ª–∞–¥ (Heap):**

```cpp
class MinHeap {
    std::vector<int> arr;
    
    int parent(int i) { return (i - 1) / 2; }
    int left(int i) { return 2 * i + 1; }
    int right(int i) { return 2 * i + 2; }
    
public:
    void insert(int key) {
        arr.push_back(key);
        int i = arr.size() - 1;
        
        // Bubble up
        while (i != 0 && arr[parent(i)] > arr[i]) {
            std::swap(arr[i], arr[parent(i)]);
            i = parent(i);
        }
    }
};
```

**–ü–µ—Ä–µ–≤–∞–≥–∏ array-based trees:**
- ‚úì No pointers (–µ–∫–æ–Ω–æ–º—ñ—è –ø–∞–º'—è—Ç—ñ –¥–ª—è complete trees)
- ‚úì Cache-friendly (continuous memory)
- ‚úì –®–≤–∏–¥—à–∞ –Ω–∞–≤—ñ–≥–∞—Ü—ñ—è (arithmetic vs pointer dereferencing)

**–ù–µ–¥–æ–ª—ñ–∫–∏:**
- ‚úó Waste  space –¥–ª—è non-complete trees
- ‚úó –§—ñ–∫—Å–æ–≤–∞–Ω–∏–π —Ä–æ–∑–º—ñ—Ä (–∞–±–æ –¥–∏–Ω–∞–º—ñ—á–Ω–µ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è)

---

## –ß–∞—Å—Ç–∏–Ω–∞ 2: –ü—Ä–æ–±–ª–µ–º–∞ ‚Äî –ù–µ–∑–±–∞–ª–∞–Ω—Å–æ–≤–∞–Ω—ñ –¥–µ—Ä–µ–≤–∞

### –ù–∞–π–≥—ñ—Ä—à–∏–π –≤–∏–ø–∞–¥–æ–∫

–í—Å—Ç–∞–≤–∫–∞ –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ—Å—Ç—ñ `1, 2, 3, 4, 5`:

```
1
 \
  2
   \
    3
     \
      4
       \
        5
```

**–í–∏—Å–æ—Ç–∞:** h = n ‚Üí **O(n) –¥–ª—è –≤—Å—ñ—Ö –æ–ø–µ—Ä–∞—Ü—ñ–π!** –¶–µ –¥–µ–≥—Ä–∞–¥–∞—Ü—ñ—è –¥–æ —Å–ø–∏—Å–∫—É.

### –†—ñ—à–µ–Ω–Ω—è: –ë–∞–ª–∞–Ω—Å—É–≤–∞–Ω–Ω—è

–ú–∏ —Ö–æ—á–µ–º–æ –≥–∞—Ä–∞–Ω—Ç—É–≤–∞—Ç–∏, —â–æ –≤–∏—Å–æ—Ç–∞ –∑–∞–≤–∂–¥–∏ O(log n). –î–ª—è —Ü—å–æ–≥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è **—Å–∞–º–æ–±–∞–ª–∞–Ω—Å—É—é—á—ñ –¥–µ—Ä–µ–≤–∞**:
- AVL Trees (—Å—Ç—Ä–æ–≥–µ –±–∞–ª–∞–Ω—Å—É–≤–∞–Ω–Ω—è, |h_left - h_right| ‚â§ 1)
- **Red-Black Trees** (–ø–æ—Å–ª–∞–±–ª–µ–Ω—ñ —É–º–æ–≤–∏, —à–≤–∏–¥—à—ñ –≤—Å—Ç–∞–≤–∫–∏)

---

## –ß–∞—Å—Ç–∏–Ω–∞ 3: –†–æ—Ç–∞—Ü—ñ—ó ‚Äî –ë–∞–∑–æ–≤–∞ –æ–ø–µ—Ä–∞—Ü—ñ—è

–†–æ—Ç–∞—Ü—ñ—è –∑–º—ñ–Ω—é—î —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–µ—Ä–µ–≤–∞, **–∑–±–µ—Ä—ñ–≥–∞—é—á–∏ BST –≤–ª–∞—Å—Ç–∏–≤—ñ—Å—Ç—å**.

### –õ—ñ–≤–∞ —Ä–æ—Ç–∞—Ü—ñ—è (Left Rotation)

**–î–æ:**
```
    x
   / \
  A   y
     / \
    B   C
```

**–ü—ñ—Å–ª—è:**
```
    y
   / \
  x   C
 / \
A   B
```

**–ö–æ–¥:**
```cpp
Node* rotate_left(Node* x) {
    Node* y = x->right;
    Node* B = y->left;
    
    // –í–∏–∫–æ–Ω—É—î–º–æ —Ä–æ—Ç–∞—Ü—ñ—é
    y->left = x;
    x->right = B;
    
    // –û–Ω–æ–≤–ª—é—î–º–æ parent –≤–∫–∞–∑—ñ–≤–Ω–∏–∫–∏
    y->parent = x->parent;
    x->parent = y;
    if (B) B->parent = x;
    
    return y;  // –ù–æ–≤–∏–π –∫–æ—Ä—ñ–Ω—å
}
```

### –ü—Ä–∞–≤–∞ —Ä–æ—Ç–∞—Ü—ñ—è (Right Rotation)

**–î–æ:**
```
      y
     / \
    x   C
   / \
  A   B
```

**–ü—ñ—Å–ª—è:**
```
    x
   / \
  A   y
     / \
    B   C
```

**–ö–æ–¥:**
```cpp
Node* rotate_right(Node* y) {
    Node* x = y->left;
    Node* B = x->right;
    
    // –í–∏–∫–æ–Ω—É—î–º–æ —Ä–æ—Ç–∞—Ü—ñ—é
    x->right = y;
    y->left = B;
    
    // –û–Ω–æ–≤–ª—é—î–º–æ parent
    x->parent = y->parent;
    y->parent = x;
    if (B) B->parent = y;
    
    return x;  // –ù–æ–≤–∏–π –∫–æ—Ä—ñ–Ω—å
}
```

**–í–∞–∂–ª–∏–≤–æ:** –†–æ—Ç–∞—Ü—ñ—ó **–∑–∞–≤–∂–¥–∏ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å BST –≤–ª–∞—Å—Ç–∏–≤—ñ—Å—Ç—å**. –ú–æ–∂–Ω–∞ –¥–æ–≤–µ—Å—Ç–∏ —ñ–Ω–¥—É–∫—Ü—ñ—î—é.

---

## –ß–∞—Å—Ç–∏–Ω–∞ 4: Red-Black Tree ‚Äî –í–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ

### –í–∏–∑–Ω–∞—á–µ–Ω–Ω—è

Red-Black –¥–µ—Ä–µ–≤–æ ‚Äî —Ü–µ BST –∑ –¥–æ–¥–∞—Ç–∫–æ–≤–æ—é —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—î—é (–∫–æ–ª—ñ—Ä –≤—É–∑–ª–∞: RED –∞–±–æ BLACK) —Ç–∞ 5 –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—è–º–∏:

1. **–ö–æ–∂–µ–Ω –≤—É–∑–æ–ª –∞–±–æ —á–µ—Ä–≤–æ–Ω–∏–π, –∞–±–æ —á–æ—Ä–Ω–∏–π**
2. **–ö–æ—Ä—ñ–Ω—å —á–æ—Ä–Ω–∏–π**
3. **–í—Å—ñ –ª–∏—Å—Ç—è (NIL) —á–æ—Ä–Ω—ñ**
4. **–ß–µ—Ä–≤–æ–Ω–∏–π –≤—É–∑–æ–ª –Ω–µ –º–æ–∂–µ –º–∞—Ç–∏ —á–µ—Ä–≤–æ–Ω–∏—Ö –¥—ñ—Ç–µ–π** (no two reds in a row)
5. **–í—Å—ñ —à–ª—è—Ö–∏ –≤—ñ–¥ –∫–æ—Ä–µ–Ω—è –¥–æ –ª–∏—Å—Ç—è –º–∞—é—Ç—å –æ–¥–Ω–∞–∫–æ–≤—É –∫—ñ–ª—å–∫—ñ—Å—Ç—å —á–æ—Ä–Ω–∏—Ö –≤—É–∑–ª—ñ–≤** (black-height)

### –ü—Ä–∏–∫–ª–∞–¥

> **üí° Visual Diagram from Source Material**  
> [PDF: Maps.pdf, Page 152]

**Notation:** `‚óè` = Black node, `‚óã` = Red node

```
       [10‚óè]  ‚Üê Black root (property 2)
       /    \
    [5‚óã]    [15‚óè]  ‚Üê Red left, Black right
    /  \       \
 [3‚óè] [7‚óè]   [20‚óã]  ‚Üê All children of Red node are Black (property 4)
  |    |      |
 NIL  NIL    NIL   ‚Üê All leaves (NIL) are Black (property 3)
```

**–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç–µ–π:**
- ‚úì Property 2: –ö–æ—Ä—ñ–Ω—å 10 —á–æ—Ä–Ω–∏–π
- ‚úì Property 4: –ù–µ–º–∞—î –¥–≤–æ—Ö —á–µ—Ä–≤–æ–Ω–∏—Ö –ø—ñ–¥—Ä—è–¥ (5‚óã –º–∞—î —á–æ—Ä–Ω–∏—Ö –¥—ñ—Ç–µ–π 3‚óè —Ç–∞ 7‚óè)
- ‚úì Property 5: Black-height –≤—ñ–¥ –∫–æ—Ä–µ–Ω—è –¥–æ –∫–æ–∂–Ω–æ–≥–æ –ª–∏—Å—Ç–∞ = 2

**Black-height calculation (from root to leaves):**
```
Path 1:  10‚óè ‚Üí 5‚óã ‚Üí 3‚óè ‚Üí NIL  |  Black count: 3 (10, 3, NIL)
Path 2:  10‚óè ‚Üí 5‚óã ‚Üí 7‚óè ‚Üí NIL  |  Black count: 3 (10, 7, NIL)
Path 3:  10‚óè ‚Üí 15‚óè ‚Üí 20‚óã ‚Üí NIL |  Black count: 3 (10, 15, NIL)
                              All paths have 3 black nodes ‚úì
```

**Visual Legend:**
- ‚óè (Black) = Filled circle = contributes to black-height
- ‚óã (Red) = Empty circle = does NOT contribute to black-height
- NIL = Implicit black leaf nodes

### –ß–æ–º—É —Ü–µ –≥–∞—Ä–∞–Ω—Ç—É—î O(log n)?

**–¢–µ–æ—Ä–µ–º–∞:** –î–µ—Ä–µ–≤–æ –∑ n –≤—É–∑–ª–∞–º–∏ –º–∞—î –≤–∏—Å–æ—Ç—É h ‚â§ 2 * log‚ÇÇ(n + 1).

**–î–æ–∫–∞–∑ (—ñ–¥–µ—è):** –ó–∞–≤–¥—è–∫–∏ –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ 5, black-height ‚â• h/2. –ê –∫—ñ–ª—å–∫—ñ—Å—Ç—å –≤—É–∑–ª—ñ–≤ –∑ black-height bh ‚â• 2^bh - 1. –û—Ç–∂–µ, n ‚â• 2^(h/2) - 1 ‚Üí h ‚â§ 2 * log‚ÇÇ(n + 1).

---

## –ß–∞—Å—Ç–∏–Ω–∞ 5: Red-Black –í—Å—Ç–∞–≤–∫–∞ ‚Äî –ü–æ–∫—Ä–æ–∫–æ–≤–∞ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è

### –ê–ª–≥–æ—Ä–∏—Ç–º

1. **–í—Å—Ç–∞–≤–ª—è—î–º–æ –Ω–æ–≤–∏–π –≤—É–∑–æ–ª —è–∫ —É –∑–≤–∏—á–∞–π–Ω–æ–º—É BST**
2. **–§–∞—Ä–±—É—î–º–æ –π–æ–≥–æ –≤ RED**
3. **–í—ñ–¥–Ω–æ–≤–ª—é—î–º–æ –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ RB-–¥–µ—Ä–µ–≤–∞**

### –í–∏–ø–∞–¥–∫–∏ –ø–æ—Ä—É—à–µ–Ω–Ω—è (–ø—ñ—Å–ª—è –≤—Å—Ç–∞–≤–∫–∏ RED –≤—É–∑–ª–∞)

**–ü—Ä–æ–±–ª–µ–º–∞:** –ë–∞—Ç—å–∫–æ —Ç–∞–∫–æ–∂ RED (–ø–æ—Ä—É—à–µ–Ω–Ω—è –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ 4).

**–í–∏–ø–∞–¥–æ–∫ 1:** –î—è–¥—å–∫–æ (uncle) —Ç–µ–∂ RED
- **–î—ñ—è:** –ü–µ—Ä–µ—Ñ–∞—Ä–±—É–≤–∞—Ç–∏ –±–∞—Ç—å–∫–∞, –¥—è–¥—å–∫–∞, –¥—ñ–¥–∞
```
        [GB]                [GR]
       /    \              /    \
   [PR]    [UR]   ‚Üí    [PB]    [UB]
    /                    /
 [NR]                [NR]
```

**–í–∏–ø–∞–¥–æ–∫ 2:** –î—è–¥—å–∫–æ BLACK, –Ω–æ–≤–∏–π –≤—É–∑–æ–ª ‚Äî –ø—Ä–∞–≤–∏–π –Ω–∞—â–∞–¥–æ–∫
- **–î—ñ—è:** –õ—ñ–≤–∞ —Ä–æ—Ç–∞—Ü—ñ—è –Ω–∞ –±–∞—Ç—å–∫–æ–≤—ñ, –ø–æ—Ç—ñ–º –≤–∏–ø–∞–¥–æ–∫ 3

**–í–∏–ø–∞–¥–æ–∫ 3:** –î—è–¥—å–∫–æ BLACK, –Ω–æ–≤–∏–π –≤—É–∑–æ–ª ‚Äî –ª—ñ–≤–∏–π –Ω–∞—â–∞–¥–æ–∫
- **–î—ñ—è:** –ü—Ä–∞–≤–∞ —Ä–æ—Ç–∞—Ü—ñ—è –Ω–∞ –¥—ñ–¥–æ–≤—ñ + –ø–µ—Ä–µ—Ñ–∞—Ä–±—É–≤–∞–Ω–Ω—è
```
        [GB]                [PB]
       /                   /    \
   [PR]         ‚Üí       [NR]   [GR]
    /
 [NR]
```

### –ü—Å–µ–≤–¥–æ–∫–æ–¥ –≤—Å—Ç–∞–≤–∫–∏

```cpp
void insert_fixup(Node* z) {
    while (z->parent && z->parent->color == RED) {
        if (z->parent == z->parent->parent->left) {
            Node* uncle = z->parent->parent->right;
            
            if (uncle && uncle->color == RED) {
                // Case 1: Uncle is RED
                z->parent->color = BLACK;
                uncle->color = BLACK;
                z->parent->parent->color = RED;
                z = z->parent->parent;
            } else {
                if (z == z->parent->right) {
                    // Case 2: Node is right child
                    z = z->parent;
                    rotate_left(z);
                }
                // Case 3: Node is left child
                z->parent->color = BLACK;
                z->parent->parent->color = RED;
                rotate_right(z->parent->parent);
            }
        } else {
            // Symmetric cases (mirror image)
            // ...
        }
    }
    root->color = BLACK;  // Ensure root is black
}
```

---

## –ß–∞—Å—Ç–∏–Ω–∞ 6: –ß–æ–º—É std::map –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î RB-Trees?

### –ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è –∑ AVL Trees

| –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞ | AVL Tree | Red-Black Tree |
|----------------|----------|----------------|
| **–ë–∞–ª–∞–Ω—Å—É–≤–∞–Ω–Ω—è** | –°—Ç—Ä–æ–≥–µ (|h_L - h_R| ‚â§ 1) | –ü–æ—Å–ª–∞–±–ª–µ–Ω–µ (h ‚â§ 2*log n) |
| **–í–∏—Å–æ—Ç–∞** | ~1.44 * log n | ~2 * log n |
| **–í—Å—Ç–∞–≤–∫–∞/–í–∏–¥–∞–ª–µ–Ω–Ω—è** | –ü–æ–≤—ñ–ª—å–Ω—ñ—à–µ (–±—ñ–ª—å—à–µ —Ä–æ—Ç–∞—Ü—ñ–π) | **–®–≤–∏–¥—à–µ** |
| **–ü–æ—à—É–∫** | –¢—Ä–æ—Ö–∏ —à–≤–∏–¥—à–µ | –¢—Ä–æ—Ö–∏ –ø–æ–≤—ñ–ª—å–Ω—ñ—à–µ |
| **–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è** | –ö–æ–ª–∏ –±–∞–≥–∞—Ç–æ –ø–æ—à—É–∫—ñ–≤ | **std::map, std::set** |

**–í–∏—Å–Ω–æ–≤–æ–∫:** RB-Trees ‚Äî —Ö–æ—Ä–æ—à–∏–π –±–∞–ª–∞–Ω—Å –º—ñ–∂ —à–≤–∏–¥–∫—ñ—Å—Ç—é –≤—Å—Ç–∞–≤–∫–∏ —Ç–∞ –ø–æ—à—É–∫—É.

### –ì–∞—Ä–∞–Ω—Ç—ñ—ó std::map

- `insert()`: O(log n) guaranteed
- `find()`: O(log n) guaranteed
- `erase()`: O(log n) guaranteed

–ë–µ–∑ –±–∞–ª–∞–Ω—Å—É–≤–∞–Ω–Ω—è —Ü–µ –±—É–ª–∏ –± O(n) —É –Ω–∞–π–≥—ñ—Ä—à–æ–º—É –≤–∏–ø–∞–¥–∫—É!

---

## –ü—Ä–∞–∫—Ç–∏—á–Ω–µ –∑–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è

**–î–∏–≤.:** [–ü—Ä–∞–∫—Ç–∏–∫—É–º 19: BST Implementation](p19_bst_implementation.md) ‚Äî —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—è BST –∑ —Ä–æ—Ç–∞—Ü—ñ—è–º–∏ —Ç–∞ –≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—î—é.

---

## –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ñ –ø–∏—Ç–∞–Ω–Ω—è

1. –ß–æ–º—É —Ä–æ—Ç–∞—Ü—ñ—è –∑–±–µ—Ä—ñ–≥–∞—î BST –≤–ª–∞—Å—Ç–∏–≤—ñ—Å—Ç—å?

<details markdown="1">
<summary>–í—ñ–¥–ø–æ–≤—ñ–¥—å</summary>

–†–æ–∑–≥–ª—è–Ω–µ–º–æ –ª—ñ–≤—É —Ä–æ—Ç–∞—Ü—ñ—é –Ω–∞ –≤—É–∑–ª—ñ `x`:
- –î–æ: `A < x < B < y < C`
- –ü—ñ—Å–ª—è: `A < x < B < y < C` (–ø–æ—Ä—è–¥–æ–∫ –Ω–µ –∑–º—ñ–Ω–∏–≤—Å—è!)

–†–æ—Ç–∞—Ü—ñ—è –ª–∏—à–µ **–ø–µ—Ä–µ–º—ñ—â—É—î –≤—É–∑–ª–∏**, –∞–ª–µ –Ω–µ –∑–º—ñ–Ω—é—î —ó—Ö –≤—ñ–¥–Ω–æ—Å–Ω–∏–π –ø–æ—Ä—è–¥–æ–∫. –£—Å—ñ, —â–æ –±—É–ª–∏ –º–µ–Ω—à—ñ –∑–∞ x, –∑–∞–ª–∏—à–∞—é—Ç—å—Å—è –º–µ–Ω—à–∏–º–∏. –£—Å—ñ, —â–æ –±—É–ª–∏ –±—ñ–ª—å—à–∏–º–∏ –∑–∞ y, –∑–∞–ª–∏—à–∞—é—Ç—å—Å—è –±—ñ–ª—å—à–∏–º–∏.

</details>

2. –ß–∏ –º–æ–∂–µ RB-–¥–µ—Ä–µ–≤–æ –º–∞—Ç–∏ –¥–≤–∞ —á–µ—Ä–≤–æ–Ω—ñ –≤—É–∑–ª–∏ –ø–æ—Å–ø—ñ–ª—å?

<details markdown="1">
<summary>–í—ñ–¥–ø–æ–≤—ñ–¥—å</summary>

**–ù—ñ!** –¶–µ –ø–æ—Ä—É—à–µ–Ω–Ω—è –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ 4. –Ø–∫—â–æ –ø—ñ—Å–ª—è –≤—Å—Ç–∞–≤–∫–∏ –∑'—è–≤–ª—è—é—Ç—å—Å—è –¥–≤–∞ —á–µ—Ä–≤–æ–Ω—ñ –ø—ñ–¥—Ä—è–¥, –º–∏ –Ω–µ–≥–∞–π–Ω–æ –≤–∏–ø—Ä–∞–≤–ª—è—î–º–æ —Ü–µ —á–µ—Ä–µ–∑ –ø–µ—Ä–µ—Ñ–∞—Ä–±—É–≤–∞–Ω–Ω—è –∞–±–æ —Ä–æ—Ç–∞—Ü—ñ—ó.

</details>

3. –Ø–∫–∞ black-height –¥–µ—Ä–µ–≤–∞ –∑ 1000 –≤—É–∑–ª—ñ–≤?

<details markdown="1">
<summary>–í—ñ–¥–ø–æ–≤—ñ–¥—å</summary>

Black-height bh ‚â• h/2, –∞ h ‚â§ 2*log‚ÇÇ(1001) ‚âà 20.

–û—Ç–∂–µ, bh ‚â• 10. –§–∞–∫—Ç–∏—á–Ω–æ, –¥–ª—è RB-–¥–µ—Ä–µ–≤–∞ –∑ 1000 –≤—É–∑–ª—ñ–≤ black-height –±–ª–∏–∑—å–∫–∞ –¥–æ 9-11.

</details>

4. –ß–æ–º—É –≤—Å—Ç–∞–≤–∫–∞ —É RB-–¥–µ—Ä–µ–≤–æ –º–æ–∂–µ –≤–∏–º–∞–≥–∞—Ç–∏ O(log n) —Ä–æ—Ç–∞—Ü—ñ–π, –∞–ª–µ –∞–º–æ—Ä—Ç–∏–∑–æ–≤–∞–Ω–∞ —Å–∫–ª–∞–¥–Ω—ñ—Å—Ç—å O(1) —Ä–æ—Ç–∞—Ü—ñ–π?

<details markdown="1">
<summary>–í—ñ–¥–ø–æ–≤—ñ–¥—å</summary>

**–ù–∞—Å–ø—Ä–∞–≤–¥—ñ, –≤—Å—Ç–∞–≤–∫–∞ –≤–∏–º–∞–≥–∞—î –º–∞–∫—Å–∏–º—É–º 2 —Ä–æ—Ç–∞—Ü—ñ—ó!**

–í–∏–ø–∞–¥–æ–∫ 1 (–¥—è–¥—å–∫–æ RED) ‚Äî 0 —Ä–æ—Ç–∞—Ü—ñ–π, –∞–ª–µ –º–æ–∂–µ–º–æ —Ä—É—Ö–∞—Ç–∏—Å—è –≤–≥–æ—Ä—É –ø–æ –¥–µ—Ä–µ–≤—É.
–í–∏–ø–∞–¥–æ–∫ 2+3 (–¥—è–¥—å–∫–æ BLACK) ‚Äî –º–∞–∫—Å–∏–º—É–º 2 —Ä–æ—Ç–∞—Ü—ñ—ó (–æ–¥–Ω–∞ —É –≤–∏–ø–∞–¥–∫—É 2, –æ–¥–Ω–∞ —É –≤–∏–ø–∞–¥–∫—É 3), —ñ –∞–ª–≥–æ—Ä–∏—Ç–º –∑—É–ø–∏–Ω—è—î—Ç—å—Å—è.

–û—Ç–∂–µ, –≤—Å—Ç–∞–≤–∫–∞ = O(log n) –ø–µ—Ä–µ—Ñ–∞—Ä–±—É–≤–∞–Ω—å + O(1) —Ä–æ—Ç–∞—Ü—ñ–π.

</details>
